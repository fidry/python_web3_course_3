// Добавляем слушатель, который срабатывает при установке расширения
chrome.runtime.onInstalled.addListener(() => {
    // Обновляем динамические правила для фильтрации сетевых запросов
    chrome.declarativeNetRequest.updateDynamicRules({
        addRules: [
            {
                // Уникальный идентификатор правила
                "id": 1,
                // Приоритет правила (чем выше число, тем выше приоритет)
                "priority": 1,
                // Действие, которое будет выполнено при совпадении условия
                "action": { 
                    "type": "modifyHeaders", // Тип действия: изменение заголовков
                    "responseHeaders": [
                        { 
                            "header": "content-security-policy", // Заголовок для удаления
                            "operation": "remove" // Операция: удалить заголовок
                        },
                        { 
                            "header": "x-frame-options", // Еще один заголовок для удаления
                            "operation": "remove" // Операция: удалить заголовок
                        }
                    ]
                },
                // Условия, при которых правило будет применяться
                "condition": { 
                    "urlFilter": "|*://*/*", // Фильтр URL: все URL-адреса
                    "resourceTypes": ["main_frame", "sub_frame"] // Типы ресурсов: основной и вложенные фреймы
                }
            }
        ],
        // Удаляем правило с идентификатором 1, если оно уже существует
        removeRuleIds: [1]
    });
});
